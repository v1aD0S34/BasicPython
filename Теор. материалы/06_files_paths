{"cells":[{"cell_type":"markdown","source":["# Чтение и запись в файл"],"metadata":{"id":"Cg38edBVm5qF"}},{"cell_type":"markdown","source":["Создадим простой файл:"],"metadata":{"id":"izujTWWXrnDs"}},{"cell_type":"code","source":["%%file testfile.txt\n","Hello, world!\n","This is a test file."],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"zPMWmdDflXj6","executionInfo":{"status":"ok","timestamp":1674805322303,"user_tz":-180,"elapsed":424,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"03137af3-39aa-4d09-a80f-392417fb93d0"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Writing testfile.txt\n"]}]},{"cell_type":"markdown","source":["## Открытие файла"],"metadata":{"id":"YqTyexIQo7MX"}},{"cell_type":"markdown","metadata":{"deletable":true,"editable":true,"id":"_TUJzRkGfOOw"},"source":["Для открытия фалы используем команду `open`. Она принимает 2 аргумента - путь до файла и режим (по-умолчанию, `'r'`):"]},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"Z9XZgS3FfOOz","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674805351475,"user_tz":-180,"elapsed":10,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"eeb0e1ff-d767-4611-8391-72a450754467"},"source":["f = open('testfile.txt', 'r')\n","f"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<_io.TextIOWrapper name='testfile.txt' mode='r' encoding='UTF-8'>"]},"metadata":{},"execution_count":78}]},{"cell_type":"code","source":["type(f)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"KUuW9He8mfZS","executionInfo":{"status":"ok","timestamp":1674662764337,"user_tz":-180,"elapsed":2,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"866eac90-7238-4b63-98ff-b07fe094c47a"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["_io.TextIOWrapper"]},"metadata":{},"execution_count":81}]},{"cell_type":"markdown","source":["Существуют следующие режимы открытия файлов:\n","- `r`- чтение файла, курсор в начале файла, выдает ошибку, если файла нет\n","- `r+` - чтение и запись файла, курсор в начале файла, выдает ошибку, если файла нет, при записи не перезатирает файл полностью\n","- `w` - запись файла, курсор в начале файла, перезатирает файл полностью\n","- `w+` - запись и чтение файла, курсор в начале файла, перезатирает файл полностью\n","- `a` - запись файла, курсор в конце файла\n","- `a+` - запись и чтение файла, курсор в конце файла"],"metadata":{"id":"M5Fq_1zBpDoX"}},{"cell_type":"markdown","source":["##### Примечание для смешариков - бинарный режим"],"metadata":{"id":"y-jqLP3CqinA"}},{"cell_type":"markdown","source":["В Python имеется еще одна \"ось\" режимов работы с файлами - текстовый (`t`) или бинарный (`b`) режимы.\n","\n","По-умолчанию файлы открываются в текстовом режиме. Если вам необходимо работать с файлом в необработанном виде и манипулировать буквально байтами данных, то можете добавить к вышеуказанным в списке режимам буквы `b` (`r+b` - чтение и запись в бинарном формате)"],"metadata":{"id":"xphWXy8sqnT_"}},{"cell_type":"markdown","source":["### Контекстный менеджер функции `open`"],"metadata":{"id":"yf8pwNC7rmJI"}},{"cell_type":"markdown","metadata":{"deletable":true,"editable":true,"id":"4v2sNpU-fOO3"},"source":["После работы с файлом его необходимо закрыть:\n"]},{"cell_type":"code","metadata":{"collapsed":true,"deletable":true,"editable":true,"id":"L6eEconzfOO3"},"source":["f.close()"],"execution_count":null,"outputs":[]},{"cell_type":"code","source":["f.closed"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"sYj7-LrcI52I","executionInfo":{"status":"ok","timestamp":1674805539301,"user_tz":-180,"elapsed":6,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"07f9a179-d2ad-4acd-f97f-bf6aebfbd242"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":80}]},{"cell_type":"markdown","source":["Общий формат работы с файлом выглядит так:"],"metadata":{"id":"vYdsbHS4mraO"}},{"cell_type":"code","metadata":{"id":"DpNVSiiMKOPV"},"source":["# open()\n","# work with file\n","# close()"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Что будет, если до вызова метода `close` при исполнении программы встретится ошибка? Выполнение программы будет прервано - файл не будет корректно закрыт!"],"metadata":{"id":"6iQmBfk7r6EY"}},{"cell_type":"markdown","source":["Чтобы даже при возникновении ошибки файл закрывался, функцию open можно использовать в виде **менеджера контекста**."],"metadata":{"id":"tSow6hbwsLgj"}},{"cell_type":"markdown","source":["**Менеджер контекста** - конструкция, оборачивающая набор команд, которая позволяет выполнять определенные операции непосредственно перед обернутым набором команд и после (разные наборы команд перед и после), даже если во время исполнения обернутого набора команд возникнет ошибка."],"metadata":{"id":"ceIs0KLKsZ0A"}},{"cell_type":"markdown","source":["```python\n","with <context_manager> as <variable>:\n","    some_code()\n","```"],"metadata":{"id":"9I5uVsmPs-Qv"}},{"cell_type":"markdown","source":["В случае с открытием файлов рекомендуется вместо:"],"metadata":{"id":"j994gRlHtHSq"}},{"cell_type":"code","source":["f = open('testfile.txt', 'r')\n","print(f.name)\n","# do something else\n","f.close()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"h9vZu98QtSEO","executionInfo":{"status":"ok","timestamp":1674805630878,"user_tz":-180,"elapsed":321,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"8deaadce-3a65-4eb5-eca1-49b8c22ac27c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["testfile.txt\n"]}]},{"cell_type":"code","source":["f.closed"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"12b9PUMZt2RE","executionInfo":{"status":"ok","timestamp":1674805631207,"user_tz":-180,"elapsed":14,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"2f48f86c-200f-4541-d1d2-191cddbaf8ca"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":82}]},{"cell_type":"markdown","source":["использовать следующее:"],"metadata":{"id":"5u8w2bg6tHAN"}},{"cell_type":"code","source":["with open('testfile.txt', 'r') as f:\n","    print(f.name)\n","    # do something else"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HX-9-cuItt6P","executionInfo":{"status":"ok","timestamp":1674805657810,"user_tz":-180,"elapsed":27,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"bd175d73-04bc-4d04-881b-7b02198168fe"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["testfile.txt\n"]}]},{"cell_type":"code","source":["f.closed"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"c_lAoftvt34k","executionInfo":{"status":"ok","timestamp":1674805657812,"user_tz":-180,"elapsed":21,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"887eebf3-de61-4474-cd15-2b3a431666fa"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":85}]},{"cell_type":"markdown","source":["#### Пример"],"metadata":{"id":"2JEUjLSaw_38"}},{"cell_type":"markdown","metadata":{"deletable":true,"editable":true,"id":"8voxVsf8fOO9"},"source":["Теперь посмотрим, чем же оператор `with` лучше, чем пара `open` - `close`."]},{"cell_type":"code","metadata":{"collapsed":true,"deletable":true,"editable":true,"id":"5dOGPtOAfOO9","colab":{"base_uri":"https://localhost:8080/","height":237},"executionInfo":{"status":"error","timestamp":1674805687134,"user_tz":-180,"elapsed":307,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"1addf706-4e9a-45fe-d18b-66e46c6670f3"},"source":["f = open('testfile.txt', 'r')\n","print(f\"File opened {f.name}\")\n","line = f.readline()\n","n = 1 / 0\n","f.close()"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["File opened testfile.txt\n"]},{"output_type":"error","ename":"ZeroDivisionError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mZeroDivisionError\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-86-44d323c35369>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf\"File opened {f.name}\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0mline\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mreadline\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 4\u001b[0;31m \u001b[0mn\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;36m1\u001b[0m \u001b[0;34m/\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      5\u001b[0m \u001b[0mf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mclose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mZeroDivisionError\u001b[0m: division by zero"]}]},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"colab":{"base_uri":"https://localhost:8080/"},"id":"_S1AmqPwfOO-","executionInfo":{"status":"ok","timestamp":1674805697401,"user_tz":-180,"elapsed":395,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"981a6795-2ec6-4b68-a15b-63b6d9c21a64"},"source":["f.closed"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["False"]},"metadata":{},"execution_count":87}]},{"cell_type":"markdown","metadata":{"deletable":true,"editable":true,"id":"00pDllA5fOO-"},"source":["Произошло исключение, мы завершили выполнение кода ячейки до строчки `close`, и файл не закрылся. Закроем файл."]},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"zSvUdpdNfOO-","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674805711121,"user_tz":-180,"elapsed":421,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"16fe88aa-bcd4-4a00-bb10-5ffaa1b1ed2d"},"source":["f.close()\n","f.closed"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":88}]},{"cell_type":"markdown","source":["Теперь повторим то же самое, но с помощью контекстного менеджера:/"],"metadata":{"id":"ph-LxOK_yFti"}},{"cell_type":"code","metadata":{"collapsed":true,"deletable":true,"editable":true,"id":"8M8p-ZwofOO_","colab":{"base_uri":"https://localhost:8080/","height":219},"executionInfo":{"status":"error","timestamp":1674805720041,"user_tz":-180,"elapsed":434,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"555bf33b-fad4-477b-82c7-58e41d94366f"},"source":["with open('testfile.txt', 'r') as f:\n","    print(f\"File opened {f.name}\")\n","    line = f.readline()\n","    n = 1 / 0"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["File opened testfile.txt\n"]},{"output_type":"error","ename":"ZeroDivisionError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mZeroDivisionError\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-89-eb3a2596b0ec>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      2\u001b[0m     \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf\"File opened {f.name}\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m     \u001b[0mline\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mreadline\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 4\u001b[0;31m     \u001b[0mn\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;36m1\u001b[0m \u001b[0;34m/\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mZeroDivisionError\u001b[0m: division by zero"]}]},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"VfuIw2OKfOO_","executionInfo":{"status":"ok","timestamp":1674805725641,"user_tz":-180,"elapsed":294,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"3348b90e-99e4-4d85-c5d2-0be463083b30"},"source":["f.closed"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":90}]},{"cell_type":"markdown","metadata":{"deletable":true,"editable":true,"id":"2M9_CrsIfOO_"},"source":["Теперь всё в порядке."]},{"cell_type":"markdown","source":["## Чтение файла"],"metadata":{"id":"qV2jSM7AryKf"}},{"cell_type":"markdown","source":["Итак, мы научились открывать файл. Как мы теперь можем прочитать его содержимое?"],"metadata":{"id":"Jm3jCkDUuANy"}},{"cell_type":"markdown","source":["### Цикл `for`"],"metadata":{"id":"KIqthtITuJHN"}},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"VVyMeQdnfOO2","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674805812192,"user_tz":-180,"elapsed":17,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"a538e5b4-0e93-4e0e-b635-93ae670b8856"},"source":["with open('testfile.txt', 'r') as f:\n","    for i, line in enumerate(f):\n","        print(i, line, end='')"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["0 Hello, world!\n","1 This is a test file.\n"]}]},{"cell_type":"markdown","source":["### Метод `readline`"],"metadata":{"id":"LfaRU6TcwaCQ"}},{"cell_type":"markdown","source":["Если хотим прочитать файл построчно, то пользуемся методом `readline`:"],"metadata":{"id":"0vVdgkignTIR"}},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"colab":{"base_uri":"https://localhost:8080/"},"id":"5drUgnNkfOO8","executionInfo":{"status":"ok","timestamp":1674664108813,"user_tz":-180,"elapsed":285,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"872ab37b-0c52-483f-b632-283d09cfdbe2"},"source":["with open('testfile.txt') as f:\n","    count = 0\n","    while True:\n","        s = f.readline()\n","        if s == '':\n","            break\n","        print(f'count: {count}, {s.__repr__()}')\n","        count += 1"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["count: 0, 'Hello, world!\\n'\n","count: 1, 'This is a test.\\n'\n"]}]},{"cell_type":"code","metadata":{"id":"_SpjHzFpL3lJ","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674664133617,"user_tz":-180,"elapsed":421,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"e62b5cc4-4174-4894-a0fe-5ebe39540f6e"},"source":["with open('testfile.txt') as f:\n","    s1 = f.readline()[:-1]\n","    s2 = f.readline()[:-1]\n","    s3 = f.readline()[:-1]\n","\n","print(s1, s2, s3, sep='\\n')"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Hello, world!\n","This is a test.\n","\n"]}]},{"cell_type":"markdown","source":["### Метод `readlines`"],"metadata":{"id":"Cq7wYqbAwzKT"}},{"cell_type":"markdown","metadata":{"deletable":true,"editable":true,"id":"F8QVYE0-fOO8"},"source":["Метод `f.readlines()` возвращает список строк (его лучше не применять для очень больших файлов)."]},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"colab":{"base_uri":"https://localhost:8080/"},"id":"DrjMn2S_fOO9","executionInfo":{"status":"ok","timestamp":1665402424935,"user_tz":-180,"elapsed":399,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"b4e6e8ae-2e96-4953-cc89-00eb263f0da9"},"source":["with open('text.txt') as f:\n","    lst_of_words = f.readlines()\n","lst_of_words"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['abcd\\n', 'efgh\\n', 'ijkl\\n']"]},"metadata":{},"execution_count":76}]},{"cell_type":"markdown","source":["### Метод `read`"],"metadata":{"id":"glV7YS_OuUqj"}},{"cell_type":"markdown","source":["Метод read позволяет считать файл двумя образами:"],"metadata":{"id":"IGlYuczUuXma"}},{"cell_type":"markdown","source":["1. Считать файл целиком"],"metadata":{"id":"JZLBBd8JughL"}},{"cell_type":"code","source":["with open('testfile.txt') as f:\n","    content = f.read()  # Не указываем аргумент - читаем файл целиком\n","    print(content)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Mx5W7BmJuj-p","executionInfo":{"status":"ok","timestamp":1674663603786,"user_tz":-180,"elapsed":313,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"f5d257c4-7e72-4655-81b1-b1980046d4d9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Hello, world!\n","This is a test.\n","\n"]}]},{"cell_type":"markdown","source":["2. Считать N символов файла"],"metadata":{"id":"fVEtTrVNuxo8"}},{"cell_type":"code","source":["with open('testfile.txt') as f:\n","    chars = f.read(10)  # Указываем аргумент 10 - читаем 10 символов\n","    print(chars)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2AN_YhQvuwgY","executionInfo":{"status":"ok","timestamp":1674663668264,"user_tz":-180,"elapsed":372,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"bffddf54-677e-4ebe-eccb-0184746ba0bd"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Hello, wor\n"]}]},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"colab":{"base_uri":"https://localhost:8080/"},"id":"71l2WwVTfOO6","executionInfo":{"status":"ok","timestamp":1674663760142,"user_tz":-180,"elapsed":327,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"34295940-3c7a-4c2f-9931-f53874f92393"},"source":["with open('testfile.txt') as f:\n","    chars = f.read(4)\n","    while len(chars) != 0:\n","        print(chars, end='*')\n","        chars = f.read(4)"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Hell*o, w*orld*!\n","Th*is i*s a *test*.\n","*"]}]},{"cell_type":"markdown","source":[">**Примечание** - читать файл полностью нужно с большой осторожностью!\n",">\n",">Если вы заранее не знаете размер файла или ваша программа даже теоретически может быть запущена для файла крайне большого размера (больше размера вашей оперативной памяти), то ни в коем случае не считывайте файл полностью:\n",">- не используйте метод `readlines`!\n",">- не используйте метод `read` без аргумента\n",">\n",">Иначе заполните всю оперативку вашим текстом и все упадет!\n",">\n",">Безопаснее считывать файл построчно (`readline`) или пакетами символов (указывая аргумент метода `read`)."],"metadata":{"id":"wzexHjjWvabW"}},{"cell_type":"markdown","source":["## Запись в файл"],"metadata":{"id":"ZlvOLzper8YH"}},{"cell_type":"markdown","source":["Чтобы открыть файл на запись, можно указать в качестве второго аргумента `'w'` и использовать метод `write`:"],"metadata":{"id":"fl89qhOyr8Pv"}},{"cell_type":"code","metadata":{"collapsed":true,"deletable":true,"editable":true,"id":"ypQctoTXfOPA"},"source":["with open('newtext.txt', 'w') as f:\n","    f.write('aaa\\n')\n","    f.write('bbb\\n')\n","    f.write('bbb\\n')"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"FFgsA3d9NhbS","executionInfo":{"status":"ok","timestamp":1674664832567,"user_tz":-180,"elapsed":23,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"e7e360b0-3c48-4d9a-df1f-34388034243f"},"source":["!cat newtext.txt"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["aaa\n","bbb\n","bbb\n"]}]},{"cell_type":"markdown","source":["#### Копирование текстового файла"],"metadata":{"id":"h-zfyrtizYp1"}},{"cell_type":"markdown","metadata":{"deletable":true,"editable":true,"id":"4VFPp7jffOPB"},"source":["Создадим функцию, которая копирует старый текстовый файл в новый. Если строки нужно как-нибудь обработать, в последней строчке вместо `line` будет стоять что-нибудь вроде `f(line)`:"]},{"cell_type":"code","metadata":{"collapsed":true,"deletable":true,"editable":true,"id":"00Kk9VUjfOPC"},"source":["old_name = 'testfile.txt'\n","new_name = 'new_testfile.txt'\n","\n","with open(old_name) as old, open(new_name, 'w') as new:\n","    for line in old:\n","        new.write(line)"],"execution_count":null,"outputs":[]},{"cell_type":"code","source":["old_name = 'testfile.txt'\n","new_name = 'new_testfile.txt'\n","\n","with open(old_name) as old:\n","    with open(new_name, 'w') as new:\n","        for line in old:\n","            new.write(line)"],"metadata":{"id":"-XOtYbYEODmI"},"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"colab":{"base_uri":"https://localhost:8080/"},"id":"b9SHjRqUfOPC","executionInfo":{"status":"ok","timestamp":1674664932201,"user_tz":-180,"elapsed":263,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"68b6935d-62e8-4336-e635-36a5c9300a46"},"source":["!cat new_testfile.txt"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Hello, world!\n","This is a test.\n"]}]},{"cell_type":"markdown","metadata":{"id":"AmFvt0AUGTbW"},"source":["## Файлы с разными кодировками"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-e-Pb8lMGTbX"},"outputs":[],"source":["with open('unicode_file.txt', 'w', encoding='utf-16le') as f:\n","    f.write('韩国烧酒')"]},{"cell_type":"markdown","metadata":{"id":"bMmh36lFGTbX"},"source":["При некорректно указанной кодировке вылезет ошибка:"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3lAnusFPGTbX","outputId":"b385dc78-b6a2-4884-c6ff-b8eb95a5684e","colab":{"base_uri":"https://localhost:8080/","height":306},"executionInfo":{"status":"error","timestamp":1665402878816,"user_tz":-180,"elapsed":646,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}}},"outputs":[{"output_type":"error","ename":"UnicodeDecodeError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mUnicodeDecodeError\u001b[0m                        Traceback (most recent call last)","\u001b[0;32m<ipython-input-104-35fe901e1e13>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;32mwith\u001b[0m \u001b[0mopen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'unicode_file.txt'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'r'\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mf\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m     \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/lib/python3.7/codecs.py\u001b[0m in \u001b[0;36mdecode\u001b[0;34m(self, input, final)\u001b[0m\n\u001b[1;32m    320\u001b[0m         \u001b[0;31m# decode input (taking the buffer into account)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    321\u001b[0m         \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mbuffer\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 322\u001b[0;31m         \u001b[0;34m(\u001b[0m\u001b[0mresult\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mconsumed\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_buffer_decode\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0merrors\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfinal\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    323\u001b[0m         \u001b[0;31m# keep undecoded input until the next call\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    324\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mbuffer\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mconsumed\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mUnicodeDecodeError\u001b[0m: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte"]}],"source":["with open('unicode_file.txt', 'r') as f:\n","    print(f.read())"]},{"cell_type":"markdown","metadata":{"id":"U_Vu5MUmGTbX"},"source":["Проверим с корректной кодировкой:"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lm3VO-sPGTbX","outputId":"278c88a2-4c28-4a4a-e16d-ab922b334f01","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1665402922933,"user_tz":-180,"elapsed":15,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["韩国烧酒\n"]}],"source":["with open('unicode_file.txt', 'r', encoding='utf-16le') as f:\n","    print(f.read())"]},{"cell_type":"markdown","metadata":{"id":"4Q_b7c2IH8gI"},"source":["# Работа с путями в Python. Библиотека Pathlib"]},{"cell_type":"markdown","source":["При работе с файлами часто приходится открывать файлы, находящиеся не в одной директории с исполняемой программой. Поэтому важно иметь возможность корректно указать путь до необходимого файла."],"metadata":{"id":"nS72_Ty2qD6V"}},{"cell_type":"markdown","source":["Плохим вариантом для этого будет просто относиться к путям как строкам:\n","\n","```python\n","data_folder = \"source_data/text_files/\"\n","file_to_open = data_folder + \"raw_data.txt\"\n","f = open(file_to_open)\n","print(f.read())\n","```"],"metadata":{"id":"q_Ya4T24qd4n"}},{"cell_type":"markdown","source":["Такой код может не сработать для некоторых библиотек на некоторых ОС."],"metadata":{"id":"Bt_fR8FcqxLf"}},{"cell_type":"markdown","source":["Более хороший вариант - использовать модуль `os.path`:\n","\n","```python\n","import os.path\n","\n","data_folder = os.path.join(\"source_data\", \"text_files\")\n","file_to_open = os.path.join(data_folder, \"raw_data.txt\")\n","f = open(file_to_open)\n","print(f.read())\n","```\n","\n","Этот код корректно сработает на всех ОС, но использовать его очень больно."],"metadata":{"id":"-FVT4q_7q3WH"}},{"cell_type":"markdown","source":["На текущий момент лучшее решение - модуль [`pathlib`](https://docs.python.org/3/library/pathlib.html) и его класс `Path`:"],"metadata":{"id":"Rq105Hx0rNF-"}},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"Nx4REfzJfOPF","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674669897605,"user_tz":-180,"elapsed":18,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"2f0f20ad-e863-4f2d-d619-f42b1f5ed52d"},"source":["from pathlib import Path\n","type(Path)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["type"]},"metadata":{},"execution_count":112}]},{"cell_type":"markdown","metadata":{"deletable":true,"editable":true,"id":"Uapk0YTQfOPF"},"source":["`Path()` возвращает текущую директорию."]},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"_tzz5JKnfOPF","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674669898024,"user_tz":-180,"elapsed":12,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"bb1da060-8351-45c8-c420-5adaef1e6fb9"},"source":["p = Path()\n","p, print(p)"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":[".\n"]},{"output_type":"execute_result","data":{"text/plain":["(PosixPath('.'), None)"]},"metadata":{},"execution_count":113}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"M50nvhmcp4FC","executionInfo":{"status":"ok","timestamp":1674669898358,"user_tz":-180,"elapsed":15,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"8ab72cd4-1ed9-43fa-b513-a82f13511f80"},"source":["type(p)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["pathlib.PosixPath"]},"metadata":{},"execution_count":114}]},{"cell_type":"markdown","metadata":{"deletable":true,"editable":true,"id":"rK9uw6vCfOPF"},"source":["Очень полезный метод `resolve` приводит путь к каноническому виду."]},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"R0ve0m_ufOPG","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674669899512,"user_tz":-180,"elapsed":12,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"a3574d33-f930-4237-e99b-9f7dbdc64a0e"},"source":["p.resolve()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["PosixPath('/content')"]},"metadata":{},"execution_count":115}]},{"cell_type":"code","source":["%%bash\n","cat ./text.txt"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":366},"id":"GiRQ25rEXhs4","executionInfo":{"status":"error","timestamp":1674669899934,"user_tz":-180,"elapsed":28,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"03bfbcec-24cf-4075-804b-3bc9bc345bc5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["cat: ./text.txt: No such file or directory\n"]},{"output_type":"error","ename":"CalledProcessError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mCalledProcessError\u001b[0m                        Traceback (most recent call last)","\u001b[0;32m<ipython-input-116-2b6f78026549>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mget_ipython\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrun_cell_magic\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'bash'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m''\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'cat ./text.txt\\n'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.8/dist-packages/IPython/core/interactiveshell.py\u001b[0m in \u001b[0;36mrun_cell_magic\u001b[0;34m(self, magic_name, line, cell)\u001b[0m\n\u001b[1;32m   2357\u001b[0m             \u001b[0;32mwith\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mbuiltin_trap\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2358\u001b[0m                 \u001b[0margs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mmagic_arg_s\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcell\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2359\u001b[0;31m                 \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2360\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mresult\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2361\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.8/dist-packages/IPython/core/magics/script.py\u001b[0m in \u001b[0;36mnamed_script_magic\u001b[0;34m(line, cell)\u001b[0m\n\u001b[1;32m    140\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    141\u001b[0m                 \u001b[0mline\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mscript\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 142\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshebang\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mline\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcell\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    143\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    144\u001b[0m         \u001b[0;31m# write a basic docstring:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m<decorator-gen-103>\u001b[0m in \u001b[0;36mshebang\u001b[0;34m(self, line, cell)\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.8/dist-packages/IPython/core/magic.py\u001b[0m in \u001b[0;36m<lambda>\u001b[0;34m(f, *a, **k)\u001b[0m\n\u001b[1;32m    185\u001b[0m     \u001b[0;31m# but it's overkill for just that one bit of state.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    186\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mmagic_deco\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0marg\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 187\u001b[0;31m         \u001b[0mcall\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mlambda\u001b[0m \u001b[0mf\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0ma\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mk\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0ma\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mk\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    188\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    189\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mcallable\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0marg\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.8/dist-packages/IPython/core/magics/script.py\u001b[0m in \u001b[0;36mshebang\u001b[0;34m(self, line, cell)\u001b[0m\n\u001b[1;32m    243\u001b[0m             \u001b[0msys\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstderr\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mflush\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    244\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0margs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mraise_error\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mreturncode\u001b[0m\u001b[0;34m!=\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 245\u001b[0;31m             \u001b[0;32mraise\u001b[0m \u001b[0mCalledProcessError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mreturncode\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcell\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moutput\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mout\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mstderr\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0merr\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    246\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    247\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_run_script\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mp\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcell\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mto_close\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mCalledProcessError\u001b[0m: Command 'b'cat ./text.txt\\n'' returned non-zero exit status 1."]}]},{"cell_type":"code","source":["%%bash\n","ls ../.."],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"r7WWgZyKX2Bv","executionInfo":{"status":"ok","timestamp":1674669909928,"user_tz":-180,"elapsed":311,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"83bc12d9-1363-4f9e-8804-eeffa33a0ebf"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["bin\n","boot\n","content\n","datalab\n","dev\n","etc\n","home\n","lib\n","lib32\n","lib64\n","libx32\n","media\n","mnt\n","NGC-DL-CONTAINER-LICENSE\n","opt\n","proc\n","root\n","run\n","sbin\n","srv\n","sys\n","tmp\n","tools\n","usr\n","var\n"]}]},{"cell_type":"markdown","metadata":{"deletable":true,"editable":true,"id":"HG86tAPwfOPG"},"source":["Путь может быть записан в совершенно глупом виде; `resolve` его исправит."]},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"Wu6b4na-fOPG","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674669916363,"user_tz":-180,"elapsed":325,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"9216659e-89b6-41f9-97c5-b89a6ad9e989"},"source":["p = Path('.././/book')\n","p = p.resolve()\n","p"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["PosixPath('/book')"]},"metadata":{},"execution_count":118}]},{"cell_type":"markdown","metadata":{"deletable":true,"editable":true,"id":"VVnTjjNCfOPG"},"source":["Статический метод `cwd` возвращает текущую директорию (current working directory)."]},{"cell_type":"code","metadata":{"id":"lQ0q2pbRT4JO","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674669917957,"user_tz":-180,"elapsed":28,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"fa8b6820-aacf-453a-a274-c53636806fde"},"source":["!pwd"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/content\n"]}]},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"ZVB5GDtMfOPG","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674669917957,"user_tz":-180,"elapsed":10,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"4b726bc9-6f1b-4726-e863-3f70e72535b0"},"source":["Path.cwd()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["PosixPath('/content')"]},"metadata":{},"execution_count":120}]},{"cell_type":"markdown","metadata":{"deletable":true,"editable":true,"id":"UsfS1lyLfOPH"},"source":["Если `p` - путь к директории, то можно посмотреть все файлы в ней с помощью метода `iterdir` (проитерироваться по директории):"]},{"cell_type":"code","metadata":{"id":"g2I73K-1UHBQ"},"source":["p = Path('./sample_data')"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"wm-NFnHJfOPH","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674669923326,"user_tz":-180,"elapsed":7,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"7befd63c-33b5-48f9-a634-c06519c09a66"},"source":["for f in p.iterdir():\n","    print(f)"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["sample_data/anscombe.json\n","sample_data/README.md\n","sample_data/mnist_train_small.csv\n","sample_data/mnist_test.csv\n","sample_data/california_housing_test.csv\n","sample_data/california_housing_train.csv\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"hOCEh8gsnt0k","executionInfo":{"status":"ok","timestamp":1674669924695,"user_tz":-180,"elapsed":15,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"8ba40ba4-c253-4212-d510-2d9877a454eb"},"source":["type(p.iterdir())"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["generator"]},"metadata":{},"execution_count":123}]},{"cell_type":"markdown","metadata":{"deletable":true,"editable":true,"id":"f4MuleHjfOPH"},"source":["Если `p` - путь к директории, то `p/'fname'` - путь к файлу `fname` в ней (он, конечно, тоже может быть директорией)."]},{"cell_type":"code","metadata":{"id":"wjz0QmCgUYtD"},"source":["%%bash\n","mkdir sample_data/dir1\n","mkdir sample_data/dir2\n","mkdir sample_data/dir3/\n","mkdir sample_data/dir3/subdir3"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"trIP9j03U3jQ","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674669927329,"user_tz":-180,"elapsed":6,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"695b13ab-d193-4d92-8d19-cf4816d506d1"},"source":["p"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["PosixPath('sample_data')"]},"metadata":{},"execution_count":125}]},{"cell_type":"code","source":["d = Path('dir3')"],"metadata":{"id":"8oNhx15IPykr"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["`str(p) + '/' + str(d) + '.txt'`"],"metadata":{"id":"fNu3jyFB4244"}},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"ePAv_rdCfOPH","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674669947181,"user_tz":-180,"elapsed":13,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"4f38c182-3d1d-4bf9-9cb2-34b0c98f7bfb"},"source":["p2 = p / d\n","p2"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["PosixPath('sample_data/dir3')"]},"metadata":{},"execution_count":131}]},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"DizTeBXjfOPI","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674669944989,"user_tz":-180,"elapsed":277,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"07a60300-c5c9-4384-d7a6-561bf61c9c00"},"source":["p2.exists()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":130}]},{"cell_type":"code","metadata":{"id":"6AcqEVsvVFB8"},"source":["p3 = p / 'dir4'"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"m4VQng3DVQAx","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674669955380,"user_tz":-180,"elapsed":13,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"fef4b0cd-2b7c-4063-e19e-e461899f67b6"},"source":["p3.exists()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["False"]},"metadata":{},"execution_count":133}]},{"cell_type":"markdown","source":["Чтобы понять, что находится по тому или иному действительному пути (файл, папка или символьная ссылка), существуют следующие методы:"],"metadata":{"id":"YghXSLqVG694"}},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"yL49XSDFfOPK","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674670014851,"user_tz":-180,"elapsed":290,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"8bdd0b6a-e591-4447-e485-5b376a1764a8"},"source":["p2.is_file(), p2.is_dir(), p2.is_symlink()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(False, True, False)"]},"metadata":{},"execution_count":134}]},{"cell_type":"code","metadata":{"id":"594-Y13qVlnH","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674670015141,"user_tz":-180,"elapsed":7,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"829b6d8f-3507-44a7-8d34-7dcec86afff9"},"source":["p2"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["PosixPath('sample_data/dir3')"]},"metadata":{},"execution_count":135}]},{"cell_type":"markdown","source":["Разобрать путь на отдельные составляющие можно с помощью `parts`:"],"metadata":{"id":"PGQpCAzzHKNR"}},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"kK9i_6_vpUQN","executionInfo":{"status":"ok","timestamp":1664390477561,"user_tz":-180,"elapsed":388,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"b450e6bd-e515-420c-8065-48a405c91575"},"source":["Path('/content/sample_data/mnist_test.csv').parts"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["('/', 'content', 'sample_data', 'mnist_test.csv')"]},"metadata":{},"execution_count":163}]},{"cell_type":"markdown","source":["Получить абсолютный путь по относительному удобно с помощью метода `absolute`:"],"metadata":{"id":"Bya7uub_HR_E"}},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"ZdBtc1mKfOPL","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674670084397,"user_tz":-180,"elapsed":343,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"9988eae6-2ddd-41f5-f96c-f9313bd06663"},"source":["print(p2.absolute().parts, p2)"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["('/', 'content', 'sample_data', 'dir3') sample_data/dir3\n"]}]},{"cell_type":"markdown","source":["Узнать родительскую директорию - `parent`:"],"metadata":{"id":"y6CkW0LfHanF"}},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"KtGyG6HrfOPL","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1674670084710,"user_tz":-180,"elapsed":16,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"cdd70e56-cf04-4287-9a62-31f33db01e37"},"source":["p2.parent, p2.parent.parent, p2.parent.parent.parent"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(PosixPath('sample_data'), PosixPath('.'), PosixPath('.'))"]},"metadata":{},"execution_count":137}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tNro3kjipx0S","executionInfo":{"status":"ok","timestamp":1664390542549,"user_tz":-180,"elapsed":241,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"d9ccd62c-d4e9-4ccd-b001-4070df800f74"},"source":["type(p2.parent)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["pathlib.PosixPath"]},"metadata":{},"execution_count":166}]},{"cell_type":"code","source":["p2 = Path('/content/sample_data/mnist_test.csv')"],"metadata":{"id":"U2SmWNUWaIn5"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Вычленить из названия файла его имя и расширение можно с помощью следующих методов:"],"metadata":{"id":"3UeAZiq-HhIE"}},{"cell_type":"code","metadata":{"deletable":true,"editable":true,"id":"CJCPMrs4fOPL","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1664390597516,"user_tz":-180,"elapsed":264,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"72402089-228b-4a52-947c-b35e86ffd4a2"},"source":["p2.name, p2.stem, p2.suffix"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["('mnist_test.csv', 'mnist_test', '.csv')"]},"metadata":{},"execution_count":169}]},{"cell_type":"code","source":["with open(p2) as f:\n","    print(f.readline())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VIZZPzRzSNqm","executionInfo":{"status":"ok","timestamp":1664390669765,"user_tz":-180,"elapsed":238,"user":{"displayName":"Nikita Chestnov","userId":"16607095869821949390"}},"outputId":"58aee3e8-ea76-48ef-88ce-769abecfd65e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,84,185,159,151,60,36,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,222,254,254,254,254,241,198,198,198,198,198,198,198,198,170,52,0,0,0,0,0,0,0,0,0,0,0,0,67,114,72,114,163,227,254,225,254,254,254,250,229,254,254,140,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,66,14,67,67,67,59,21,236,254,106,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,83,253,209,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,22,233,255,83,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,129,254,238,44,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,59,249,254,62,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,133,254,187,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,205,248,58,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,126,254,182,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,75,251,240,57,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,221,254,166,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,203,254,219,35,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,38,254,254,77,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,224,254,115,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,133,254,254,52,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,61,242,254,254,52,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,121,254,254,219,40,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,121,254,207,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\n","\n"]}]},{"cell_type":"markdown","source":["Найти в папке все файлы с по заданной маске - `rglob`:"],"metadata":{"id":"lwFVXn6MHpce"}},{"cell_type":"code","source":["for item in p.rglob(\"*.csv\"):\n","    print(item)"],"metadata":{"id":"3M0mRKwza1KZ"},"execution_count":null,"outputs":[]}],"metadata":{"celltoolbar":"Слайд-шоу","kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.5"},"colab":{"provenance":[{"file_id":"1mPXQejQySqryTH3DOXvkr-voRQ_4FBCp","timestamp":1707640984365},{"file_id":"1y7L49m1ngg0aziqqQo7O0pkdobPLjqwR","timestamp":1674647680280},{"file_id":"1OhnYst3SVeA27sF8S_CwyEJRsXgA3UoG","timestamp":1665324910775}],"collapsed_sections":["y-jqLP3CqinA"],"toc_visible":true}},"nbformat":4,"nbformat_minor":0}